%p{:style => "color: red;"}
  Before registering for this event read the league details, regulations, settings and you understand all of these.
- if @show_reg
  = render :partial => 'league_entry'
- else
  - if @league.is_registered?(current_user)
    You are participating in this race.
    %br
    If you can not take part, please remove yourself ASAP
    = link_to "Exit race", exit_league_path(@league)
  - elsif @league.league_entries.length.eql?(@league.max_players)
    Entries closed, maximum players entered.
  - elsif !@league.is_registered?(current_user)
    = link_to("Click here", enter_league_path(@league)) + " to enter race (#{@league.max_players - @league.users.length} spaces left)"
- if @league.league_entries.length > 0
  %br
  %br
  - @entries_by_class.each do |name, entries|
    %h4
      = name
    - if entries.blank?
      No entries to this class yet
    - else
      %table{:class => "race-table", :style => "width: 50%;"}
        %tr
          %th
            Username
          %th
            PSN Name
          %th
            Car
          %th
            Class
          - if @league.organiser.eql?(current_user)
            %th
        - entries.each do |entry|
          %tr
            %td
              = entry.user.username
            %td
              = entry.user.psn_name
            %td
              = entry.league_car.car_name
            %td
              = entry.league_car.car_class.name
            - if @league.organiser.eql?(current_user)
              %td{:style => "width: 8px"}
                = link_to 'Remove driver', admin_exit_league_path(@league, entry.user), :confirm => 'Are you sure?', :method => :delete, :class => "ui-icon ui-icon-trash", :title => "Remove driver", :style => "float: left;"
- else
  No entries yet